[{"path":"/articles/protDP.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Main results and figures","text":"file, demonstrate relationship missingness intensity using public datasets precursor protein levels.","code":""},{"path":"/articles/protDP.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Main results and figures","text":"","code":"library(tidyverse) library(protDP)"},{"path":[]},{"path":"/articles/protDP.html","id":"data-summary","dir":"Articles","previous_headings":"Dataset A: A DIA-NN subset of three","what":"Data summary","title":"Main results and figures","text":"overall proportion missing data","code":"data(\"diannSubset\") dim(diannSubset) [1] 34689     3 diannSubset[1:5, ]                                   1A    2A    3A AAAAAAAAAPAAAATAPTTAATTAATAAQ3  8.16  8.23  8.29 AAAAAAALQAK2                    9.85  9.79  9.84 AAAAEIAVK2                        NA  3.52    NA AAAALAGGKK2                     1.03  2.61  2.90 AAADALSDLEIK2                  10.14 10.15 10.19 sum(is.na(diannSubset)) / length(diannSubset) [1] 0.0863"},{"path":"/articles/protDP.html","id":"empirical-logistic-splines-for-detected-proportions","dir":"Articles","previous_headings":"Dataset A: A DIA-NN subset of three","what":"Empirical logistic splines for detected proportions","title":"Main results and figures","text":"Consider natural cubic splines generated 1, 3 5 degrees freedom:","code":"nuis <- getNuisance(diannSubset) dfList <- seq(1, 5, 2) lineColours <- RColorBrewer::brewer.pal(4, \"Dark2\") allFits <- list() for (df in dfList) {   params0 <- logitSplines_start(dp = nuis$dp, mu = nuis$mu_obs, wt = nuis$wt, df = df)   fit <- logit_ztbinom(dp = nuis$dp, X = params0$X, wt = nuis$wt, beta0 = params0$betas_start)   allFits[[(df+1)/2]] <- fit   if (df == 1)     plotEmpSplines(nuis, X = params0$X, fit$params, ylim = c(0, 1.04),                     lineCol = lineColours[(df+1)/2], capped = FALSE)   if (df > 1)     plotEmpSplines(nuis, X = params0$X, fit$params,                     plot.dotts = FALSE, ylim = c(0, 1.04),                     lineCol = lineColours[(df+1)/2], capped = FALSE) } legend(\"bottomright\", legend = paste(\"df = \", dfList), col = lineColours, lwd = 2, lty = 1)"},{"path":"/articles/protDP.html","id":"reduced-deviance-compared-to-an-intercept-model","dir":"Articles","previous_headings":"Dataset A: A DIA-NN subset of three","what":"Reduced deviance compared to an intercept model","title":"Main results and figures","text":"Fit baseline model, , logistic regression fit detection probability constant precursors.","code":"params0 <- logitSplines_start(dp = nuis$dp, mu = nuis$mu_obs, wt = nuis$wt, df = 0) baselineFit <- logit_ztbinom(dp = nuis$dp, X = params0$X, wt = nuis$wt, beta0 = params0$betas_start) baselineDev <- 2*min(baselineFit$info[, \"neg.LL\"]) devs <- data.frame(df = c(0, dfList),                     dev = c(baselineDev, sapply(allFits, function(i) 2*min(i$info[, \"neg.LL\"])))) %>%    mutate(dev.decre = baselineDev - dev,           percDevReduced = dev.decre / max(dev.decre)) ggplot(slice(devs, 2:4), aes(x = df, y = percDevReduced)) +    geom_point() +    geom_line() +   geom_text(aes(label = signif(percDevReduced, 4)), vjust = -0.8) +    scale_x_continuous(breaks = c(1, 3, 5)) +   labs(x = \"DF\", y = \"Deviance% reduced\") +    theme_classic()"},{"path":"/articles/protDP.html","id":"empirical-logit-linear-curve-with-capped-probabilities","dir":"Articles","previous_headings":"Dataset A: A DIA-NN subset of three","what":"Empirical logit-linear curve with capped probabilities","title":"Main results and figures","text":"","code":"params0 <- logitSplines_start(dp = nuis$dp, mu = nuis$mu_obs, wt = nuis$wt, df = 1) cappedLinear <- cappedLogit_ztbinom(dp = nuis$dp, X = params0$X, wt = nuis$wt,                             alpha0 = 0.9, beta0 = params0$betas_start, trace = FALSE) cappedLinear$params  alpha     b0     b1   0.997 -1.556 15.263  plotEmpSplines(nuis, X = params0$X, cappedLinear$params, lineCol = lineColours[1])"},{"path":"/articles/protDP.html","id":"detection-probability-curve-assuming-normal-observed-intensities","dir":"Articles","previous_headings":"Dataset A: A DIA-NN subset of three","what":"Detection probability curve assuming normal observed intensities","title":"Main results and figures","text":"","code":"dpcFit <- dpc(diannSubset, nuis) dpcFit$beta [1] -1.362  0.726 plotDPC(nuis, dpcFit, ylim = c(0, 1.04))"},{"path":"/articles/protDP.html","id":"dataset-b-diapasef","dir":"Articles","previous_headings":"","what":"Dataset B: diaPASEF","title":"Main results and figures","text":"Data downloaded https://www.embopress.org/doi/full/10.15252/msb.202110798. data obtained diaPASEF pipeline searched DIA-NN. Sample size 15; overall amount missingness moderate. Project accession: PXD024043 (www.ebi.ac.uk/pride/archive?keyword=PXD024043). (DIANN1.8_diaPASEF_1ng_repetitions.zip)","code":""},{"path":"/articles/protDP.html","id":"data-summary-1","dir":"Articles","previous_headings":"Dataset B: diaPASEF","what":"Data summary","title":"Main results and figures","text":"overall proportion missing data","code":"data(\"diapasef\") dim(diapasef) [1] 10754   231 diapasef[1:5, 1:5]                                      HeLa_NB_01_S3-G2_1_3873 HeLa_NB_02_S3-G3_1_3874 (UniMod:1)AAAAAAAAAAGAAGGR2                             10.1                   11.87 (UniMod:1)AAAAAAGAASGLPGPVAQGLK2                        10.7                   11.73 (UniMod:1)AAAAAAGAGPEMVR2                                 NA                   10.81 (UniMod:1)AAAAAEQQQFYLLLGNLLSPDNVVR3                      NA                    9.02 (UniMod:1)AAAAAGTATSQR2                                   NA                   11.19                                      HeLa_NB_03_S3-G4_1_3875 HeLa_NB_04_S3-G5_1_3876 (UniMod:1)AAAAAAAAAAGAAGGR2                             10.5                    11.4 (UniMod:1)AAAAAAGAASGLPGPVAQGLK2                        11.1                    11.4 (UniMod:1)AAAAAAGAGPEMVR2                               11.1                    10.9 (UniMod:1)AAAAAEQQQFYLLLGNLLSPDNVVR3                      NA                      NA (UniMod:1)AAAAAGTATSQR2                                 11.4                    11.2                                      HeLa_NB_05_S3-G6_1_3877 (UniMod:1)AAAAAAAAAAGAAGGR2                             11.7 (UniMod:1)AAAAAAGAASGLPGPVAQGLK2                        10.8 (UniMod:1)AAAAAAGAGPEMVR2                               10.8 (UniMod:1)AAAAAEQQQFYLLLGNLLSPDNVVR3                     7.4 (UniMod:1)AAAAAGTATSQR2                                 10.9 sum(is.na(diapasef)) / length(diapasef) [1] 0.604"},{"path":"/articles/protDP.html","id":"empirical-logistic-splines-for-detected-proportions-1","dir":"Articles","previous_headings":"Dataset B: diaPASEF","what":"Empirical logistic splines for detected proportions","title":"Main results and figures","text":"","code":"diapasefRes <- gatherResults(diapasef) for (i in 1:length(dfList)) {   if (i == 1)     plotEmpSplines(diapasefRes$nuis, X = diapasefRes$splineFits_params0[[i]]$X,                     diapasefRes$splineFits[[i]]$params, point.cex = 0.1,                     lineCol = lineColours[i], jitter.amount = 1/ncol(diapasef)/2,                    capped = FALSE)   if (i > 1)     plotEmpSplines(diapasefRes$nuis, X = diapasefRes$splineFits_params0[[i]]$X,                     diapasefRes$splineFits[[i]]$params,                     plot.dotts = FALSE,                     lineCol = lineColours[i], capped = FALSE) } legend(\"bottomright\", legend = paste(\"df = \", dfList), col = lineColours, lwd = 2, lty = 1)"},{"path":"/articles/protDP.html","id":"reduced-deviance-compared-to-an-intercept-model-1","dir":"Articles","previous_headings":"Dataset B: diaPASEF","what":"Reduced deviance compared to an intercept model","title":"Main results and figures","text":"","code":"diapasefRes$devPlot +    ylim(0.95, 1)"},{"path":"/articles/protDP.html","id":"empirical-logit-linear-curve-with-capped-probabilities-1","dir":"Articles","previous_headings":"Dataset B: diaPASEF","what":"Empirical logit-linear curve with capped probabilities","title":"Main results and figures","text":"","code":"diapasefRes$cappedLinearFit$params  alpha     b0     b1   0.991 -3.857 12.741  plotEmpSplines(diapasefRes$nuis, X = diapasefRes$splineFits_params0[[1]]$X,                 diapasefRes$cappedLinearFit$params, lineCol = lineColours[1],                 jitter.amount = 1/ncol(diapasef)/2,                 point.cex = 0.1)"},{"path":"/articles/protDP.html","id":"detection-probability-curve-assuming-normal-observed-intensities-1","dir":"Articles","previous_headings":"Dataset B: diaPASEF","what":"Detection probability curve assuming normal observed intensities","title":"Main results and figures","text":"","code":"diapasefRes$dpcFit$beta [1] -10.311   0.915 plotDPC(diapasefRes$nuis, diapasefRes$dpcFit, jitter.amount = 1/ncol(diapasef)/2, point.cex = 0.1)"},{"path":[]},{"path":"/articles/protDP.html","id":"data-summary-2","dir":"Articles","previous_headings":"Dataset C: A MaxDIA dataset","what":"Data summary","title":"Main results and figures","text":"overall proportion missing data","code":"data(\"maxdia\") dim(maxdia) [1] 62515    27 maxdia[1:5, 1:5]   Intensity 1 Intensity 10 Intensity 11 Intensity 12 Intensity 13 0          NA           NA           NA         24.2         24.5 1          NA         22.2         27.9           NA           NA 2        31.9         32.1         32.2         32.2         32.1 4          NA           NA         28.1         27.2           NA 5        27.7           NA           NA           NA           NA sum(is.na(maxdia)) / length(maxdia) [1] 0.328"},{"path":"/articles/protDP.html","id":"empirical-logistic-splines-for-detected-proportions-2","dir":"Articles","previous_headings":"Dataset C: A MaxDIA dataset","what":"Empirical logistic splines for detected proportions","title":"Main results and figures","text":"","code":"maxdiaRes <- gatherResults(maxdia) for (i in 1:length(dfList)) {   if (i == 1)     plotEmpSplines(maxdiaRes$nuis, X = maxdiaRes$splineFits_params0[[i]]$X,                     maxdiaRes$splineFits[[i]]$params, point.cex = 0.1,                     lineCol = lineColours[i], jitter.amount = 1/ncol(maxdia)/2,                    capped = FALSE)   if (i > 1)     plotEmpSplines(maxdiaRes$nuis, X = maxdiaRes$splineFits_params0[[i]]$X,                     maxdiaRes$splineFits[[i]]$params,                     plot.dotts = FALSE,                     lineCol = lineColours[i], capped = FALSE) } legend(\"bottomright\", legend = paste(\"df = \", dfList), col = lineColours, lwd = 2, lty = 1)"},{"path":"/articles/protDP.html","id":"reduced-deviance-compared-to-an-intercept-model-2","dir":"Articles","previous_headings":"Dataset C: A MaxDIA dataset","what":"Reduced deviance compared to an intercept model","title":"Main results and figures","text":"","code":"maxdiaRes$devPlot +    ylim(0.95, 1)"},{"path":"/articles/protDP.html","id":"empirical-logit-linear-curve-with-capped-probabilities-2","dir":"Articles","previous_headings":"Dataset C: A MaxDIA dataset","what":"Empirical logit-linear curve with capped probabilities","title":"Main results and figures","text":"","code":"maxdiaRes$cappedLinearFit$params  alpha     b0     b1   0.971 -2.493 10.751  plotEmpSplines(maxdiaRes$nuis, X = maxdiaRes$splineFits_params0[[1]]$X,                 maxdiaRes$cappedLinearFit$params, lineCol = lineColours[1],                 jitter.amount = 1/ncol(maxdia)/2,                 point.cex = 0.1)"},{"path":"/articles/protDP.html","id":"detection-probability-curve-assuming-normal-observed-intensities-2","dir":"Articles","previous_headings":"Dataset C: A MaxDIA dataset","what":"Detection probability curve assuming normal observed intensities","title":"Main results and figures","text":"","code":"maxdiaRes$dpcFit$beta [1] -10.086   0.418 plotDPC(maxdiaRes$nuis, maxdiaRes$dpcFit, jitter.amount = 1/ncol(maxdia)/2, point.cex = 0.1)"},{"path":"/articles/protDP.html","id":"dataset-d-dda-plasma-data","dir":"Articles","previous_headings":"","what":"Dataset D: DDA plasma data","title":"Main results and figures","text":"paper available https://www.mcponline.org/article/S1535-9476(20)34998-7/fulltext#seccestitle170 MaxQuant group. Use peptides.txt output MaxQuant. blood plasma sample heaps missing values. dataset identifier PXD014777.","code":""},{"path":"/articles/protDP.html","id":"data-summary-3","dir":"Articles","previous_headings":"Dataset D: DDA plasma data","what":"Data summary","title":"Main results and figures","text":"overall proportion missing data","code":"data(\"ddaPlasma\") dim(ddaPlasma) [1] 2384  212 ddaPlasma[1:5, 1:5]   S1-A1_1_2513 S1-A10_1_2522 S1-A11_1_2524 S1-A12_1_2525 S1-B1_1_2526 0         22.8          22.8          23.3            23         21.7 1           NA            NA            NA            NA           NA 2           NA            NA            NA            NA           NA 3           NA            NA            NA            NA           NA 4           NA            NA            NA            NA           NA sum(is.na(ddaPlasma)) / length(ddaPlasma) [1] 0.569"},{"path":"/articles/protDP.html","id":"empirical-logistic-splines-for-detected-proportions-3","dir":"Articles","previous_headings":"Dataset D: DDA plasma data","what":"Empirical logistic splines for detected proportions","title":"Main results and figures","text":"","code":"ddaPlasmaRes <- gatherResults(ddaPlasma) for (i in 1:length(dfList)) {   if (i == 1)     plotEmpSplines(ddaPlasmaRes$nuis, X = ddaPlasmaRes$splineFits_params0[[i]]$X,                     ddaPlasmaRes$splineFits[[i]]$params,                     lineCol = lineColours[i], add.jitter = FALSE,                     capped = FALSE)   if (i > 1)     plotEmpSplines(ddaPlasmaRes$nuis, X = ddaPlasmaRes$splineFits_params0[[i]]$X,                     ddaPlasmaRes$splineFits[[i]]$params,                     plot.dotts = FALSE,                     lineCol = lineColours[i], capped = FALSE) } legend(\"bottomright\", legend = paste(\"df = \", dfList), col = lineColours, lwd = 2, lty = 1)"},{"path":"/articles/protDP.html","id":"reduced-deviance-compared-to-an-intercept-model-3","dir":"Articles","previous_headings":"Dataset D: DDA plasma data","what":"Reduced deviance compared to an intercept model","title":"Main results and figures","text":"","code":"ddaPlasmaRes$devPlot +    ylim(0.95, 1)"},{"path":"/articles/protDP.html","id":"empirical-logit-linear-curve-with-capped-probabilities-3","dir":"Articles","previous_headings":"Dataset D: DDA plasma data","what":"Empirical logit-linear curve with capped probabilities","title":"Main results and figures","text":"","code":"ddaPlasmaRes$cappedLinearFit$params  alpha     b0     b1   0.991 -3.784 12.644  plotEmpSplines(ddaPlasmaRes$nuis, X = ddaPlasmaRes$splineFits_params0[[1]]$X,                 ddaPlasmaRes$cappedLinearFit$params,                 lineCol = lineColours[1],                 add.jitter = FALSE)"},{"path":"/articles/protDP.html","id":"detection-probability-curve-assuming-normal-observed-intensities-3","dir":"Articles","previous_headings":"Dataset D: DDA plasma data","what":"Detection probability curve assuming normal observed intensities","title":"Main results and figures","text":"","code":"ddaPlasmaRes$dpcFit$beta [1] -12.443   0.839 plotDPC(ddaPlasmaRes$nuis, ddaPlasmaRes$dpcFit, add.jitter = FALSE)"},{"path":"/articles/protDP.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Main results and figures","text":"Demichev, V., Messner, C.B., Vernardis, S.., Lilley, K.S. Ralser, M., 2020. DIA-NN: neural networks interference correction enable deep proteome coverage high throughput. Nature methods, 17(1), pp.41-44. Brunner, .D., Thielert, M., Vasilopoulou, C., Ammar, C., Coscia, F., Mund, ., Hoerning, O.B., Bache, N., Apalategui, ., Lubeck, M. Richter, S., 2022. Ultra‐high sensitivity mass spectrometry quantifies single‐cell proteome changes upon perturbation. Molecular systems biology, 18(3), p.e10798. Sinitcyn, P., Hamzeiy, H., Salinas Soto, F., Itzhak, D., McCarthy, F., Wichmann, C., Steger, M., Ohmayer, U., Distler, U., Kaspar-Schoenefeld, S. Prianichnikov, N., 2021. MaxDIA enables library-based library-free data-independent acquisition proteomics. Nature biotechnology, 39(12), pp.1563-1573. Prianichnikov, N., Koch, H., Koch, S., Lubeck, M., Heilig, R., Brehmer, S., Fischer, R. Cox, J., 2020. MaxQuant software ion mobility enhanced shotgun proteomics. Molecular & Cellular Proteomics, 19(6), pp.1058-1069.","code":""},{"path":"/articles/protDP.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Main results and figures","text":"","code":"sessionInfo() R version 4.2.0 (2022-04-22) Platform: x86_64-apple-darwin17.0 (64-bit) Running under: macOS Big Sur/Monterey 10.16  Matrix products: default BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib  locale: [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages:  [1] limma_3.52.1     protDP_0.1.0     forcats_0.5.1    stringr_1.4.0    dplyr_1.0.9       [6] purrr_0.3.4      readr_2.1.2      tidyr_1.2.0      tibble_3.1.7     ggplot2_3.3.6    [11] tidyverse_1.3.1  BiocStyle_2.24.0  loaded via a namespace (and not attached):  [1] lubridate_1.8.0     assertthat_0.2.1    rprojroot_2.0.3     digest_0.6.29        [5] utf8_1.2.2          R6_2.5.1            cellranger_1.1.0    backports_1.4.1      [9] reprex_2.0.1        evaluate_0.15       highr_0.9           httr_1.4.3          [13] pillar_1.7.0        rlang_1.0.2         readxl_1.4.0        rstudioapi_0.13     [17] jquerylib_0.1.4     rmarkdown_2.14      pkgdown_2.0.3       labeling_0.4.2      [21] splines_4.2.0       textshaping_0.3.6   desc_1.4.1          munsell_0.5.0       [25] broom_0.8.0         compiler_4.2.0      modelr_0.1.8        xfun_0.31           [29] pkgconfig_2.0.3     systemfonts_1.0.4   htmltools_0.5.2     tidyselect_1.1.2    [33] bookdown_0.26       fansi_1.0.3         crayon_1.5.1        tzdb_0.3.0          [37] dbplyr_2.1.1        withr_2.5.0         grid_4.2.0          jsonlite_1.8.0      [41] gtable_0.3.0        lifecycle_1.0.1     DBI_1.1.2           magrittr_2.0.3      [45] scales_1.2.0        cli_3.3.0           stringi_1.7.6       cachem_1.0.6        [49] farver_2.1.0        fs_1.5.2            xml2_1.3.3          bslib_0.3.1         [53] ellipsis_0.3.2      ragg_1.2.2          generics_0.1.2      vctrs_0.4.1         [57] RColorBrewer_1.1-3  tools_4.2.0         glue_1.6.2          hms_1.1.1           [61] fastmap_1.1.0       yaml_2.3.5          colorspace_2.0-3    BiocManager_1.30.18 [65] rvest_1.0.2         memoise_2.0.1       knitr_1.39          haven_2.5.0         [69] sass_0.4.1"},{"path":[]},{"path":"/articles/supp.html","id":"load-packages","dir":"Articles","previous_headings":"","what":"Load packages","title":"Supplementary results and figures","text":"Consider natural cubic splines generated 1, 3 5 degrees freedom:","code":"library(tidyverse) library(protDP) dfList <- seq(1, 5, 2) lineColours <- RColorBrewer::brewer.pal(4, \"Dark2\")"},{"path":"/articles/supp.html","id":"dataset-s1-sydney-heart-bank-data","dir":"Articles","previous_headings":"","what":"Dataset S1: Sydney heart bank data","title":"Supplementary results and figures","text":"dataset acquired DIA processed Spectronaut spectral library generated pooled DDA samples.","code":""},{"path":"/articles/supp.html","id":"data-summary","dir":"Articles","previous_headings":"Dataset S1: Sydney heart bank data","what":"Data summary","title":"Supplementary results and figures","text":"overall proportion missing data","code":"data(\"heart\") dim(heart) [1] 42742    24 heart[1:5, 1:5]                                      S1   S4   S8   S9  S14 _LVLVNAVYFR_.2                     18.6 18.5 18.4 19.0 18.6 _SC[Carbamidomethyl (C)]DFLSSFR_.2 17.3 17.6 17.3 17.9 17.7 _ADFSGMSQTDLSLSK_.2                14.8 16.1 16.0 16.5 16.1 _SGGGGDIHQGFQSLLTEVNK_.3           18.3 18.4 18.7 18.9 18.5 _SGGGGDIHQGFQSLLTEVNK_.2           18.3 18.2 18.1 18.4 15.8 sum(is.na(heart)) / length(heart) [1] 0.334"},{"path":"/articles/supp.html","id":"empirical-logistic-splines-for-detected-proportions","dir":"Articles","previous_headings":"Dataset S1: Sydney heart bank data","what":"Empirical logistic splines for detected proportions","title":"Supplementary results and figures","text":"","code":"heartRes <- gatherResults(heart) for (i in 1:length(dfList)) {   if (i == 1)     plotEmpSplines(heartRes$nuis, X = heartRes$splineFits_params0[[i]]$X,                     heartRes$splineFits[[i]]$params,                     lineCol = lineColours[i],                     jitter.amount = 1/ncol(heart)/2, point.cex = 0.1,                     capped = FALSE)   if (i > 1)     plotEmpSplines(heartRes$nuis, X = heartRes$splineFits_params0[[i]]$X,                     heartRes$splineFits[[i]]$params,                     plot.dotts = FALSE,                     lineCol = lineColours[i], capped = FALSE) } legend(\"bottomright\", legend = paste(\"df = \", dfList), col = lineColours, lwd = 2, lty = 1)"},{"path":"/articles/supp.html","id":"reduced-deviance-compared-to-an-intercept-model","dir":"Articles","previous_headings":"Dataset S1: Sydney heart bank data","what":"Reduced deviance compared to an intercept model","title":"Supplementary results and figures","text":"","code":"heartRes$devPlot +    ylim(0.95, 1)"},{"path":"/articles/supp.html","id":"empirical-logit-linear-curve-with-capped-probabilities","dir":"Articles","previous_headings":"Dataset S1: Sydney heart bank data","what":"Empirical logit-linear curve with capped probabilities","title":"Supplementary results and figures","text":"","code":"heartRes$cappedLinearFit$params alpha    b0    b1   1.00 -2.98 13.29  plotEmpSplines(heartRes$nuis, X = heartRes$splineFits_params0[[1]]$X,                 heartRes$cappedLinearFit$params,                 lineCol = lineColours[1],                 jitter.amount = 1/ncol(heart)/2, point.cex = 0.1)"},{"path":"/articles/supp.html","id":"detection-probability-curve-assuming-normal-observed-intensities","dir":"Articles","previous_headings":"Dataset S1: Sydney heart bank data","what":"Detection probability curve assuming normal observed intensities","title":"Supplementary results and figures","text":"","code":"heartRes$dpcFit$beta [1] -7.791  0.518 plotDPC(heartRes$nuis, heartRes$dpcFit, jitter.amount = 1/ncol(heart)/2, point.cex = 0.1)"},{"path":"/articles/supp.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Supplementary results and figures","text":"Li, M., Parker, B.L., Pearson, E., Hunter, B., Cao, J., Koay, Y.C., Guneratne, O., James, D.E., Yang, J., Lal, S. O’Sullivan, J.F., 2020. Core functional nodes sex-specific pathways human ischaemic dilated cardiomyopathy. Nature communications, 11(1), pp.1-12.","code":""},{"path":"/articles/supp.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Supplementary results and figures","text":"","code":"sessionInfo() R version 4.2.0 (2022-04-22) Platform: x86_64-apple-darwin17.0 (64-bit) Running under: macOS Big Sur/Monterey 10.16  Matrix products: default BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib  locale: [1] en_AU.UTF-8/en_AU.UTF-8/en_AU.UTF-8/C/en_AU.UTF-8/en_AU.UTF-8  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages:  [1] limma_3.52.1     protDP_0.1.0     forcats_0.5.1    stringr_1.4.0    dplyr_1.0.9       [6] purrr_0.3.4      readr_2.1.2      tidyr_1.2.0      tibble_3.1.7     ggplot2_3.3.6    [11] tidyverse_1.3.1  BiocStyle_2.24.0  loaded via a namespace (and not attached):  [1] lubridate_1.8.0     assertthat_0.2.1    rprojroot_2.0.3     digest_0.6.29        [5] utf8_1.2.2          R6_2.5.1            cellranger_1.1.0    backports_1.4.1      [9] reprex_2.0.1        evaluate_0.15       highr_0.9           httr_1.4.3          [13] pillar_1.7.0        rlang_1.0.2         readxl_1.4.0        rstudioapi_0.13     [17] jquerylib_0.1.4     rmarkdown_2.14      pkgdown_2.0.3       labeling_0.4.2      [21] splines_4.2.0       textshaping_0.3.6   desc_1.4.1          munsell_0.5.0       [25] broom_0.8.0         compiler_4.2.0      modelr_0.1.8        xfun_0.31           [29] pkgconfig_2.0.3     systemfonts_1.0.4   htmltools_0.5.2     tidyselect_1.1.2    [33] bookdown_0.26       fansi_1.0.3         crayon_1.5.1        tzdb_0.3.0          [37] dbplyr_2.1.1        withr_2.5.0         grid_4.2.0          jsonlite_1.8.0      [41] gtable_0.3.0        lifecycle_1.0.1     DBI_1.1.2           magrittr_2.0.3      [45] scales_1.2.0        cli_3.3.0           stringi_1.7.6       cachem_1.0.6        [49] farver_2.1.0        fs_1.5.2            xml2_1.3.3          bslib_0.3.1         [53] ellipsis_0.3.2      ragg_1.2.2          generics_0.1.2      vctrs_0.4.1         [57] RColorBrewer_1.1-3  tools_4.2.0         glue_1.6.2          hms_1.1.1           [61] fastmap_1.1.0       yaml_2.3.5          colorspace_2.0-3    BiocManager_1.30.18 [65] rvest_1.0.2         memoise_2.0.1       knitr_1.39          haven_2.5.0         [69] sass_0.4.1"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mengbo Li. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Li M (2022). protDP: Estimation Detection Probability Curve MS-based Proteomics Data. R package version 0.1.0.","code":"@Manual{,   title = {protDP: Estimation of the Detection Probability Curve in MS-based Proteomics Data},   author = {Mengbo Li},   year = {2022},   note = {R package version 0.1.0}, }"},{"path":[]},{"path":"/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Estimation of the Detection Probability Curve in MS-based Proteomics Data","text":"repository hosts example data sets ","code":""},{"path":"/reference/cappedLogit_ztbinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","title":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","text":"Fitting empirical logistic spline curve detection proportion capped probabilities","code":""},{"path":"/reference/cappedLogit_ztbinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","text":"","code":"cappedLogit_ztbinom(   dp,   X,   wt,   alpha0 = 0.8,   beta0,   maxit = 100,   trace = TRUE,   eps = 1e-04 )"},{"path":"/reference/cappedLogit_ztbinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","text":"dp vector detection proportion precursors. X basis matrix natural cubic spline. wt vector numbers trials (samples size) zero-truncated binomial distribution. alpha0 start value alpha. beta0 Start values beta coefficients. maxit Maximum number iterations. trace Logical. Whether print alpha estimates iteration. eps Convergence tolerance.","code":""},{"path":"/reference/cappedLogit_ztbinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","text":"Fitted parameters fitting history.","code":""},{"path":"/reference/cappedLogit_ztbinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting an empirical logistic spline curve for detection proportion with\ncapped probabilities — cappedLogit_ztbinom","text":"","code":"## See the vignettes."},{"path":"/reference/ddaPlasma.html","id":null,"dir":"Reference","previous_headings":"","what":"A DDA dataset — ddaPlasma","title":"A DDA dataset — ddaPlasma","text":"DDA","code":""},{"path":"/reference/ddaPlasma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A DDA dataset — ddaPlasma","text":"","code":"ddaPlasma"},{"path":"/reference/ddaPlasma.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A DDA dataset — ddaPlasma","text":"Data matrix log2-transformed precursor-level intensities.","code":""},{"path":"/reference/ddaPlasma.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A DDA dataset — ddaPlasma","text":"Prianichnikov, N., Koch, H., Koch, S., Lubeck, M., Heilig, R., Brehmer, S., Fischer, R. Cox, J., 2020. MaxQuant software ion mobility enhanced shotgun proteomics. Molecular & Cellular Proteomics, 19(6), pp.1058-1069.","code":""},{"path":"/reference/diannSubset.html","id":null,"dir":"Reference","previous_headings":"","what":"A subset of the DIA-NN data — diannSubset","title":"A subset of the DIA-NN data — diannSubset","text":"DIA-NN data","code":""},{"path":"/reference/diannSubset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A subset of the DIA-NN data — diannSubset","text":"","code":"diannSubset"},{"path":"/reference/diannSubset.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subset of the DIA-NN data — diannSubset","text":"Data matrix log2-transformed precursor-level intensities.","code":""},{"path":"/reference/diannSubset.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A subset of the DIA-NN data — diannSubset","text":"Demichev, V., Messner, C.B., Vernardis, S.., Lilley, K.S. Ralser, M., 2020. DIA-NN: neural networks interference correction enable deep proteome coverage high throughput. Nature methods, 17(1), pp.41-44.","code":""},{"path":"/reference/diapasef.html","id":null,"dir":"Reference","previous_headings":"","what":"A diaPASEF dataset — diapasef","title":"A diaPASEF dataset — diapasef","text":"DIA-NN data","code":""},{"path":"/reference/diapasef.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A diaPASEF dataset — diapasef","text":"","code":"diapasef"},{"path":"/reference/diapasef.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A diaPASEF dataset — diapasef","text":"Data matrix log2-transformed precursor-level intensities.","code":""},{"path":"/reference/diapasef.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"A diaPASEF dataset — diapasef","text":"Brunner, .D., Thielert, M., Vasilopoulou, C., Ammar, C., Coscia, F., Mund, ., Hoerning, O.B., Bache, N., Apalategui, ., Lubeck, M. Richter, S., 2022. Ultra‐high sensitivity mass spectrometry quantifies single‐cell proteome changes upon perturbation. Molecular systems biology, 18(3), p.e10798.","code":""},{"path":"/reference/dpc.html","id":null,"dir":"Reference","previous_headings":"","what":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","title":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","text":"Detection probability curve mass spectrometry-based proteomics data assuming observed normal intensities","code":""},{"path":"/reference/dpc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","text":"","code":"dpc(Y, nuis, maxit = 100, eps = 1e-04, b1.upper = 1)"},{"path":"/reference/dpc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","text":"Y log2-transformed intensity matrix rows precursors columns samples. nuis list nuisance parameters. maxit Maximum number iterations. eps Convergence tolerance. b1.upper Upper bound beta_1. Typically 1.","code":""},{"path":"/reference/dpc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","text":"Fitted parameters fitting history.","code":""},{"path":"/reference/dpc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detection probability curve for mass spectrometry-based proteomics data\nassuming observed normal intensities — dpc","text":"","code":"## See the vignettes."},{"path":"/reference/gatherResults.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper function of all presented results — gatherResults","title":"Wrapper function of all presented results — gatherResults","text":"Wrapper function presented results","code":""},{"path":"/reference/gatherResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper function of all presented results — gatherResults","text":"","code":"gatherResults(data)"},{"path":"/reference/gatherResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrapper function of all presented results — gatherResults","text":"data log2-transformed intensity matrix rows precursors columns samples.","code":""},{"path":"/reference/gatherResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrapper function of all presented results — gatherResults","text":"List results including","code":""},{"path":"/reference/gatherResults.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrapper function of all presented results — gatherResults","text":"","code":"## See the vignettes."},{"path":"/reference/getNuisance.html","id":null,"dir":"Reference","previous_headings":"","what":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","title":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","text":"`getNuisance` function fits logistic-linear model detection proportion observed average intensity precursor. also returns list nuisance parameters convenience use estimating DPC, vector obeseved mean intensity precursor, total samples size eBayes-trended obeseved variances precursor.","code":""},{"path":"/reference/getNuisance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","text":"","code":"getNuisance(Y)"},{"path":"/reference/getNuisance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","text":"Y log2-transformed intensity matrix rows precursors columns samples.","code":""},{"path":"/reference/getNuisance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","text":"list nuisance parameters use estimate detection probability curve.","code":""},{"path":"/reference/getNuisance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get nuisance parameters and an initial estimation of the detection\nprobability curve (DPC) — getNuisance","text":"","code":"## NOT RUN"},{"path":"/reference/heart.html","id":null,"dir":"Reference","previous_headings":"","what":"Supplementary Dataset 1: Sydney Heart Bank data — heart","title":"Supplementary Dataset 1: Sydney Heart Bank data — heart","text":"DDA spectral library + DIA Spectronaut","code":""},{"path":"/reference/heart.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Supplementary Dataset 1: Sydney Heart Bank data — heart","text":"","code":"heart"},{"path":"/reference/heart.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Supplementary Dataset 1: Sydney Heart Bank data — heart","text":"Data matrix log2-transformed precursor-level intensities.","code":""},{"path":"/reference/heart.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Supplementary Dataset 1: Sydney Heart Bank data — heart","text":"Li, M., Parker, B.L., Pearson, E., Hunter, B., Cao, J., Koay, Y.C., Guneratne, O., James, D.E., Yang, J., Lal, S. O’Sullivan, J.F., 2020. Core functional nodes sex-specific pathways human ischaemic dilated cardiomyopathy. Nature communications, 11(1), pp.1-12.","code":""},{"path":"/reference/logitSplines_start.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","title":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","text":"Get initial estimates logistic spline fit assuming binomial detection probability","code":""},{"path":"/reference/logitSplines_start.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","text":"","code":"logitSplines_start(dp, mu, wt, df = 1)"},{"path":"/reference/logitSplines_start.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","text":"dp vector detection proportion precursors. mu vector average observed intensities precursors. wt vector numbers trials (samples size). df Degrees freedom natural cubic spline.","code":""},{"path":"/reference/logitSplines_start.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","text":"list fitted coefficients basis matrix spline.","code":""},{"path":"/reference/logitSplines_start.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the initial estimates for a logistic spline fit by assuming the\nbinomial detection probability — logitSplines_start","text":"","code":"# See the vignettes."},{"path":"/reference/logit_ztbinom.html","id":null,"dir":"Reference","previous_headings":"","what":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","title":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","text":"Fitting empirical logistic spline curve detection proportion","code":""},{"path":"/reference/logit_ztbinom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","text":"","code":"logit_ztbinom(dp, X, wt, beta0)"},{"path":"/reference/logit_ztbinom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","text":"dp vector detection proportion precursors. X basis matrix natural cubic spline. wt vector numbers trials (samples size) zero-truncated binomial distribution. beta0 Start values beta coefficients.","code":""},{"path":"/reference/logit_ztbinom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","text":"Fitted beta coefficients fitting history.","code":""},{"path":"/reference/logit_ztbinom.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fitting an empirical logistic spline curve for detection proportion — logit_ztbinom","text":"","code":"## See the vignettes."},{"path":"/reference/maxdia.html","id":null,"dir":"Reference","previous_headings":"","what":"DIA data processed by MaxDIA — maxdia","title":"DIA data processed by MaxDIA — maxdia","text":"MaxDIA data downloaded https://www.ebi.ac.uk/pride/archive/projects/PXD022589.","code":""},{"path":"/reference/maxdia.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DIA data processed by MaxDIA — maxdia","text":"","code":"maxdia"},{"path":"/reference/maxdia.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DIA data processed by MaxDIA — maxdia","text":"Data matrix log2-transformed precursor-level intensities.","code":""},{"path":"/reference/maxdia.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"DIA data processed by MaxDIA — maxdia","text":"Sinitcyn, P., Hamzeiy, H., Salinas Soto, F., Itzhak, D., McCarthy, F., Wichmann, C., Steger, M., Ohmayer, U., Distler, U., Kaspar-Schoenefeld, S. Prianichnikov, N., 2021. MaxDIA enables library-based library-free data-independent acquisition proteomics. Nature biotechnology, 39(12), pp.1563-1573","code":""},{"path":"/reference/plotDPC.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the detection probability curve — plotDPC","title":"Plot the detection probability curve — plotDPC","text":"Plot detection probability curve","code":""},{"path":"/reference/plotDPC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the detection probability curve — plotDPC","text":"","code":"plotDPC(   nuis,   dpcFit,   add.jitter = TRUE,   jitter.amount = NULL,   point.cex = 0.2,   lwd = 2,   ylim = c(0, 1),   capped = FALSE )"},{"path":"/reference/plotDPC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the detection probability curve — plotDPC","text":"nuis list nuisance parameters. dpcFit DPC fit results. add.jitter Logical. Whether add jitter detected proportion axis. jitter.amount Amount jittering. point.cex Size points. lwd Line width. ylim Limits y-axis. capped Logical. Whether probabilities capped alpha.","code":""},{"path":"/reference/plotDPC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the detection probability curve — plotDPC","text":"plot.","code":""},{"path":"/reference/plotDPC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot the detection probability curve — plotDPC","text":"","code":"# See the vignettes."},{"path":"/reference/plotEmpSplines.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a fitted empirical spline fit on detected proportions — plotEmpSplines","title":"Plot a fitted empirical spline fit on detected proportions — plotEmpSplines","text":"Plot fitted empirical spline fit detected proportions","code":""},{"path":"/reference/plotEmpSplines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a fitted empirical spline fit on detected proportions — plotEmpSplines","text":"","code":"plotEmpSplines(   nuis,   X,   params,   capped = TRUE,   logit = FALSE,   add.jitter = TRUE,   jitter.amount = NULL,   point.cex = 0.2,   plot.dotts = TRUE,   lineOnly = FALSE,   lty = \"solid\",   lineCol = \"darkgreen\",   lwd = 2,   ylim = c(0, 1) )"},{"path":"/reference/plotEmpSplines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a fitted empirical spline fit on detected proportions — plotEmpSplines","text":"nuis list nuisance parameters. X basis matrix natural cubic spline. params Fitted coefficients. capped Logical. Whether probabilities capped alpha. logit Logical. Whether plot logit scale. add.jitter Logical. Whether add jitter detected proportion axis. jitter.amount Amount jittering. point.cex Size points. plot.dotts Logical. Whether keep raw data points plot. lineOnly Logical. Whether plot fitted lines. lty Line type. lineCol Line color. lwd Line width. ylim Limits y-axis.","code":""},{"path":"/reference/plotEmpSplines.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a fitted empirical spline fit on detected proportions — plotEmpSplines","text":"","code":"# See the vignettes."}]
